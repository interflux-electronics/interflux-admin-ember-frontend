{{#with @model.product as |product|}}
  <Modal @id="product">
    {{#if product.image}}
      <Image::Responsive
        @path={{product.image.path}}
        @sizes={{product.image.sizes}}
        @formats={{product.image.formats}}
      />
    {{/if}}
    <h1>{{product.name}}</h1>

    <h2>Properties</h2>

    <Field::String
      @label='Name'
      @record={{product}}
      @attribute='name'
      @disabled='true'
    />

    <Field::OneToMany
      @label='Family'
      @record={{product}}
      @relation='productFamily'
      @filterOn='nameSingle'
    />

    <Field::String
      @label='Label'
      @record={{product}}
      @attribute='label'
    />

    <Field::String
      @label='Pitch'
      @record={{product}}
      @attribute='pitch'
      @multiline='true'
    />

    <Field::ManyToMany
      @label='Processes'
      @record={{product}}
      @relation='features'
      @relationLabel='text'
      @route='secure.processes.process'
    />

    <Field::ManyToMany
      @label='Qualities'
      @record={{product}}
      @relation='qualities'
      @relationLabel='text'
      @route='secure.features.feature'
    />

    <h2>Images</h2>

    <Fieldset
      @label='The avatar'
      @legend='If you had to present this product with only one image, which one would you choose? The avatar is the single most representative image of this product and will be shown everywhere on our website, on Google and in social media links.'
    >
      <ul class="images">
        <li class="avatar">
          <Image::Responsive
            @path={{product.image.path}}
            @sizes={{product.image.sizes}}
            @formats={{product.image.formats}}
          />

          <div class="buttons">
            <Button
              @text="View details"
              @theme="secondary"
              @route='secure.images.image'
              @model={{product.image.id}}
            />
          </div>
        </li>
      </ul>
    </Fieldset>

    <Fieldset
      @label='Shown on website'
      @legend='These images will be shown on the product page of {{product.name}}. Make sure all available sizes, containers, alloys and shapes of {{product.name}} are shown on our website.'
    >
      <ul class="images">
        {{#each this.publicImages as |relation|}}
          <li>
            <p>{{relation.rank}}{{if (eq relation.image.id product.image.id) ' - avatar'}}</p>

            <Image::Responsive
              @path={{relation.image.path}}
              @sizes={{relation.image.sizes}}
              @formats={{relation.image.formats}}
            />

            <div class="buttons">
              {{#if (not (eq relation.image.id product.image.id))}}
                <Button
                  @text="Make avatar"
                  @theme="secondary"
                  @onClick={{fn this.setAvatar relation}}
                />
              {{/if}}
              {{#if (not (eq relation.rank 1))}}
                <Button
                  @text="Move up"
                  @theme="secondary"
                  @onClick={{fn this.moveImageUp relation}}
                />
              {{/if}}
              {{#if (not (eq relation.rank this.publicImageCount))}}
                <Button
                  @text="Move down"
                  @theme="secondary"
                  @onClick={{fn this.moveImageDown relation}}
                />
              {{/if}}
              <Button
                @text="Hide from website"
                @theme="secondary"
                @onClick={{fn this.hideImage relation}}
              />
              <Button
                @text="View details"
                @theme="secondary"
                @route='secure.images.image'
                @model={{relation.image.id}}
              />
            </div>
          </li>
        {{else}}
          <p>- none -</p>
        {{/each}}
      </ul>
    </Fieldset>

    <Fieldset
      @label='Hidden images'
      @legend='These images are for internal use only and will not be shown on our website.'
    >
      <ul class="images">
        {{#each this.hiddenImages as |relation|}}
          <li>
            <Image::Responsive
              @path={{relation.image.path}}
              @sizes={{relation.image.sizes}}
              @formats={{relation.image.formats}}
            />

            <div class="buttons">
              <Button
                @text="Show on website"
                @theme="secondary"
                @onClick={{fn this.showImage relation}}
              />

              <Button
                @text="View details"
                @theme="secondary"
                @route='secure.images.image'
                @model={{relation.image.id}}
              />
            </div>
          </li>
        {{else}}
          <p>- none -</p>
        {{/each}}
      </ul>
    </Fieldset>

    <h2>Documents</h2>

    <Field::ManyToMany
      @label='Documents'
      @record={{product}}
      @relation='documents'
      @relationLabel='name'
      @route='secure.documents.document'
    />

    <h2>Website</h2>

    <p>Link:</p>
    <p>
      <Button
        @url={{product.url}}
        @text="{{product.url}}"
      />
    </p>

    <Field::Boolean
      @label='Public'
      @record={{product}}
      @attribute='public'
    />

    <Field::Boolean
      @label='Orderable'
      @record={{product}}
      @attribute='orderable'
    />

    <Field::Boolean
      @label='Featured'
      @record={{product}}
      @attribute='featured'
    />

    <Field::Boolean
      @label='Popular'
      @record={{product}}
      @attribute='popular'
    />

    <Field::Boolean
      @label='New'
      @record={{product}}
      @attribute='new'
    />

    <h2>Database</h2>

    <Field::String
      @label='Database ID'
      @record={{product}}
      @attribute='id'
      @disabled='true'
    />
  </Modal>
{{/with}}